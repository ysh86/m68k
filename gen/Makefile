TARGET_EXEC ?= m68kmake

MUSASHIGENIN = m68k_in.c
MUSASHIGENCFILES = m68kops.c
MUSASHIGENHFILES = m68kops.h


CPPFLAGS ?= $(INC_FLAGS) -MMD -MP -D_POSIX_C_SOURCE=200809L
CPPFLAGS += $(PKG_CONFIG_CFLAGS)

CFLAGS += -Wall --std=c99 -O3
CXXFLAGS += -Wall --std=c++11 -O3


.PHONY: all
all: $(TARGET_EXEC) $(MUSASHIGENHFILES)


$(TARGET_EXEC): $(TARGET_EXEC).c
	$(CC) $(CPPFLAGS) $(CFLAGS) -o $@ $<

$(MUSASHIGENCFILES) $(MUSASHIGENHFILES): $(TARGET_EXEC) $(MUSASHIGENIN)
	./$(TARGET_EXEC)
	mv $(MUSASHIGENCFILES) ../src
	mv $(MUSASHIGENHFILES) ../src


.PHONY: clean
clean:
	$(RM) *.d *.o
	$(RM) $(TARGET_EXEC)
